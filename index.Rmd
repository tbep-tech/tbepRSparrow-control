---
output: 
  html_document
runtime: shiny
---
  
```{r}
library(plyr)
library(ggplot2)
library(nlmrt)
library(numDeriv)
library(OpenMx)
library(stringr)
library(gear)
library(gplots) 
library(rgdal)
library(shiny)
library(sp)
library(spdep) 
library(data.table)
library(rstudioapi)
library(svDialogs)
library(here)

# shinyimage <- list(path_results = here('results/TampaBayTP'),
#                    file_sum = 'TampaBayTP',
#                    path_gis = here('gis'),
#                    map_uncertainties = NA,
#                    BootUncertainties = NA,
#                    scenario_name = 'scenario1',
#                    ConcFActor = 0.001143648,
#                    reach_decay_specification = "exp(-data[,jdecvar[i]] * beta1[,jbdecvar[i]])",
#                    reservoir_decay_specification = "(1 / (1 + data[,jresvar[i]] * beta1[,jbresvar[i]]))",
#                    add_vars = c('huc2', 'huc4'),
#                    csv_columnSeparator = ',',
#                    csv_decimalSeparator = '.',
#                    batch_mode = 'no',
#                    ErrorOccured = 'no',
# 
#                    data_names = data_names,
#                    mapping.input.list = mapping.input.list,
#                    subdata = subdata,
#                    SelParmValues = SelParmValues,
#                    sitedata = sitedata,
#                    estimate.list = estimate.list,
#                    DataMatrix.list = DataMatrix.list
# )
# save(here('shinyimage.RData'))

load(file = here::here('shinyimage.RData'))

for(i in 1:length(shinyimage)) 
  assign(names(shinyimage)[i], shinyimage[[i]])

path_master <- "../tbepRSparrow/"
devtools::load_all(path_master,recompile = F)  

shinyMap2(#stream/catchment
  path_results,file_sum,path_gis,map_uncertainties,BootUncertainties,
  data_names,mapping.input.list,
  subdata,SelParmValues,
  sitedata,
  scenario_name,estimate.list,
  ConcFactor,DataMatrix.list,
  reach_decay_specification,reservoir_decay_specification,
  add_vars,csv_decimalSeparator,csv_columnSeparator,
  batch_mode,ErrorOccured)

```

